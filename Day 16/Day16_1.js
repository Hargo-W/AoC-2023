const input = `\\...|.........\\........./.................\\...\\.../.\\/../|....\\................./..../........-\\..-.\\-..../...
...|....\\................../.............../-....--..........-......-......\\....-........../-..............|..
..............\\....../.........../...................|.........\\.................|.-................../.......
.........................\\........../..-........./.../..........|....................-....\\./.........|.......
.-.......\\......-.-................|......................................-..............\\......./............
............|...|..|.|............................../-..........\\..\\.......................................\\-.
...|.|.\\........./......|....|......./............/...\\......../.../.........../.../............/.-...-.|.....
..................../.....-.........\\......-....|.......................\\.....-...............................
../............|.|.-....-.........../|........-..|....|.....................-.-.....\\...-.......|.............
..-./..............-.............-......................./............/.......|.....-..........|.........../..
......|.........-|.|/..........-......................\\.|./.....\\....-..........................|./-./........
.|...-.............-.....-.............|.../..............|-........................\\........\\...|./..........
............/.........\\.......-..........|........../.....\\......\\....|...............|.......................
|...||....\\.......|..........|.....|................./.......-...................|............/...............
.......-.....\\-.....................\\...|................................|..........|......\\..\\.........-/....
............../.............................\\.........................\\|............-.........................
.......-..|........./..........|...-......././......./...../..........................|...../............/....
.-/......-.............../../........................\\............\\.....|.//.......-.................|.......\\
........-......|.....-.............\\............\\...................-...\\...............-............|........
...-.......................-...................\\....|.......-.............|./..\\....|.....................|...
.......-..\\...|/.\\........\\...........-.....................\\.../.....|.|........../.........-................
....|..../..........\\/..........-..................-............|......./.......-......\\.....||....../.....-..
|.-........................-....\\...../......\\.......|\\......-...........-......\\.............................
\\.....\\........\\........\\......................-....................\\...........-.../.........................
..-...|.|.........--.........-.|......\\........-.................\\...................................|.......|
-..|.....-.......-.......|......|./........../...........-......|..................-..........................
...................||..\\........|............\\..|............\\............-..-.......|........................
..........-..........-..|........./....|..-......./..-|...|.....\\......./...-|../.../......./..|..............
....\\|..................|......................................................../.....|.....|....||../.......
.......................-.../..|.............-.|..........|.......................-....-......-................
.......|./.............-........./...........\\..........|-........\\.....-....|....|........-.......\\....\\.....
../........./.......................|................/.....-...................|...............\\.../.....\\....
........................|...........................|.................................................../.....
|\\.....|....................-..................-.........................\\......\\...-..............-..........
..................................|.....\\..\\-|........................................................-.......
.../....-...../|-.|.....\\.../............/|......................./.....-............|.\\.......-../...........
.\\......|.......................\\..-\\.........|.....-........./............\\.......|....|...|...././....\\....-
.\\......\\..........................\\......-.......|.\\.............../...\\/.....-........|....|................
\\...-.......|\\..|............../.../...........|.............-.................-.......................\\./.|..
....-......................../.......................\\..../................\\.............\\................/..|
...-...|......../.-...........-.........................................../\\.|....-|........-\\................
\\-.../........|.......................-.....................|......./........................|...........\\.\\-.
......\\.-......./............\\.................-...|..............|./../....\\.-............-./.......|........
........./...........|.....|../........./....................|.\\..\\-..|........\\......|\\..................../.
-..........\\......-.............................\\....|......\\..........|.................-....................
.......................|.....|....................................-..\\...................................../..
......../.\\........./.../....\\.../..||.\\|......................................|........................../...
..\\..................|....../.........\\.........-....-|........-.....................-........\\...../..|......
...|.........|...|.....|.....\\..-.../...../.........-.....|............../....................................
.......\\.........\\......-...-........./.............../........./......|../.............../........-....-.....
..........|..........................\\.-...\\.........../..../..\\................|.........../.....\\...........
.........\\....../.....................................................-.............|.-.......................
......-..........|..-......-.................\\................/........../............-.|....|.|\\......-......
....\\............|..../..................|......|..-.-....\\......|./.........|...........|....//.|..-.........
|........................||...../-.........../...../.-..................................|..........-.........-
....-\\...............|.............................\\.-..../......................./....\\..............\\../.|..
......\\.|................/../..|............-.....|...\\..............................|.............|.........-
...................\\.....|...............|..\\.-......\\........../.\\...........................................
........|....................-..\\\\....................-/...../......../.|...........\\......-.|........-.......
............\\...-./........./.....................................................-...........................
\\...|.....\\...\\......................-......./..../../...............\\......./../......................-.....-
.........../.......\\..../..................................-......|.../.............././.....................\\
.....................|......\\........-......................../.|....................|...................../.-
.....\\./....\\..../\\..|...........|.-.....|..............\\..............-.\\............../.....................
.......-.....|...........\\.|\\....\\..|......|.......././............/...-...|-.-../......||...\\................
...................../...\\....|../..|................-.......\\...............................\\................
.......-.....\\\\......\\....\\...|....|......\\...........\\.\\..../.....\\.......................|.../..............
........-......................../.\\............................./................|.....|.....................
......\\-...../.|.........\\..........\\...\\/..-......................//.....................|..................\\
...............|/.........../.......................-....|..................\\........-...\\-...\\...........\\...
...-/..................................................|.........................-.......\\.-.............|....
|/......................../.........../........../....|...../............-.........\\....-.....................
.............-/....|../.............|.............-.-.\\.\\......./\\............../.....\\...|................|..
|......-.........../...|........\\........../........................................./.................-......
....|......../..-|....-..........|-..................\\.\\..\\.................\\.-..|............./.......-......
...............-.........-........../....................||.-........................-.....-.\\................
...............|........\\.......|./.../...........-...../...\\....-./....|.....................\\...\\...........
........../................................./.\\........./......./.....|.../....|./...../...........\\...|.\\.-..
.../..../........................|....-..........................-..|.\\-..............|.....\\.........-.......
......|..|........../.................|.........|..../..............././............\\-.-...............-.....-
......\\../|.|......../........................\\..\\.......|........................\\./........./...............
...../......../........\\.|.................|............................-........................|....\\.......
|.-|........|.|./.-...........-\\...-../../.../..|..........................\\.....|.........../................
..\\...././............././...../...............|./.../..../..........-........-../...-....................\\...
.....\\....................../..|.........................\\.....-/................-......................../...
...........|............................../....|.......................-........|......................./.....
../..|............-..............\\.................//..................../\\.|......-.//........./.............
........|....................../|...........|...../......|......-....\\................/.............-......||.
\\....-..............\\..............-../.....-.....................-.../............/............../.\\...-.....
./....\\...............|..................|..../.....\\..........-|......../...........-.\\./....................
/..-....../........................../.\\....\\....\\-............................../....-........\\..............
..............-.\\..............-..............\\-|....|............../..-..././..............\\..|..............
......................\\-..............|........-....-........-....................../......\\..................
................\\.|./.......|....../...-.........-..................\\............-........./.|................
...................-............................................-...|...../....\\........../...-.../...........
.....\\....................-...................\\../....................................|..........-............
..../.......\\/-.\\...-........./......./........|....................................-.........................
....|....................................-.........|\\..................\\.......-..\\.....-...\\-......|.........
................................./.................................../.-../...|.\\...............|.....\\.......
..|..........-.-\\...........................|................-.........../...\\..............-\\/............-.-
....|......./-.........|.................|............|...|.........................-.....................\\...
.-.|.........-...|.............................\\......../.\\............|..............-...\\........\\|./...|./.
..../\\...........\\............-.../..\\...................././....-..........|.........|..|.............|......
....................-..................................-...........\\|....................|...\\...|............
...-.|......................./.-...................-.../......|.........................../...................
...........................\\....|\\........\\.......\\.|...../.............-.|../.......................-........
...........................................|...-............\\......................../.............-..........
..........|.|..........\\.../.........|.....-.........-....|............-........../....../......./..-........|
.../.....\\.................\\........\\.................................../....|...-......./..........\\.....|/..
.......|....\\.....|...............|........-|.........../............/../.\\...\\......................\\........`;

const field = input.split('\n').map(line => line.split(''))

field.unshift(Array(field[0].length).fill('x'));
field.push(Array(field[0].length).fill('x'));
for (let i = 0; i < field.length; i++) {
    field[i].unshift('x');
    field[i].push('x');
}

let energizedGrid = Array.from({ length: field.length }, () =>
    Array(field[0].length).fill().map(() => []));

const energize = (coords, direction) => {
    if (!energizedGrid[coords[0]][coords[1]].includes(direction)) {
        energizedGrid[coords[0]][coords[1]].push(direction);
    }
}


const getNextCoords = (location, direction) => {
    switch (direction) {
        case 'left':
            return [location[0], location[1] - 1]
        case 'up':
            return [location[0] - 1, location[1]]
        case 'right':
            return [location[0], location[1] + 1]
        case 'down':
            return [location[0] + 1, location[1]]
    }
}

const moveTile = (location, direction) => {
    const currentTile = field[location[0]][location[1]];
    console.log(currentTile, direction)
    if (energizedGrid[location[0]][location[1]].includes(direction) || currentTile === 'x') return;


    energize(location, direction);

    let nextDirection;

    if (currentTile === '.' || (direction === 'left' && currentTile === '-') || (direction === 'right' && currentTile === '-') || (direction === 'up' && currentTile === '|') || (direction === 'down' && currentTile === '|')) {
        nextDirection = direction;
    } else if ((currentTile === '/' && direction === 'right') || (currentTile === '\\' && direction === 'left')) {
        nextDirection = 'up';
    } else if ((currentTile === '/' && direction === 'left') || (currentTile === '\\' && direction === 'right')) {
        nextDirection = 'down';
    } else if ((currentTile === '/' && direction === 'down') || (currentTile === '\\' && direction === 'up')) {
        nextDirection = 'left';
    } else if ((currentTile === '/' && direction === 'up') || (currentTile === '\\' && direction === 'down')) {
        nextDirection = 'right';
    } else if ((currentTile === '|' && direction === 'left') || (currentTile === '|' && direction === 'right')) {
        const coordsUp = getNextCoords(location, 'up');
        const coordsDown = getNextCoords(location, 'down');
        moveTile(coordsUp, 'up');
        moveTile(coordsDown, 'down');
        return;
    } else if ((currentTile === '-' && direction === 'up') || (currentTile === '-' && direction === 'down')) {
        const coordsLeft = getNextCoords(location, 'left');
        const coordsRight = getNextCoords(location, 'right');
        moveTile(coordsLeft, 'left');
        moveTile(coordsRight, 'right');
        return;
    }

    const nextCoords = getNextCoords(location, nextDirection);
    moveTile(nextCoords, nextDirection);
}

moveTile([1, 1], 'right')

let total = 0;

for (let i = 0; i < energizedGrid.length; i++) {
    for (let y = 0; y < energizedGrid[0].length; y++) {
        if (energizedGrid[i][y].length > 0) total++;
    }
}

console.log(total)